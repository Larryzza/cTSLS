% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sandwich_iv.R
\name{compute_AB3}
\alias{compute_AB3}
\title{Sandwich Variance Estimator for Two-Stage IV AFT}
\usage{
compute_AB3(fs, ss, Cov, Cov2, Naive = FALSE)
}
\arguments{
\item{fs}{A list returned by \code{first_stage()}, containing:
\code{beta} (i.e., \eqn{\alpha}), \code{fitted}, and \code{resid1}.}

\item{ss}{A list returned by \code{second_stage_wls()}, containing:
\code{theta} (i.e., \eqn{\beta}), \code{fitted}, \code{resid2}, and \code{omega2}.}

\item{Cov}{A numeric vector of covariates used in stage 1.}

\item{Cov2}{A numeric vector of covariates (excluding the endogenous variable) used in stage 2.}

\item{Naive}{Logical; whether to use the naive sandwich estimator (ignoring \eqn{\Psi^*}).}
}
\value{
A list with components:
\describe{
  \item{A}{A \eqn{4 \times 4} matrix estimating \eqn{\hat{A}} (block derivatives).}
  \item{B_naive}{A \eqn{4 \times 4} matrix estimating naive \eqn{\hat{B} = \frac{1}{n} \sum_j \Psi_j \Psi_j^T}.}
  \item{B}{A \eqn{4 \times 4} matrix estimating full \eqn{\hat{B}} (currently equals \code{B_naive}).}
}
}
\description{
Computes the asymptotic variance components \eqn{A} and \eqn{B} for the two-stage
instrumental variable accelerated failure time (IV AFT) model.
}
\details{
Under Theorem 1, the estimator satisfies the asymptotic normality:
\deqn{\sqrt{n}(\hat{\theta} - \theta) \to N(0, A^{-1} B A^{-T}).}
This function computes \eqn{\hat{A}} and the naive estimate \eqn{\hat{B}} (excluding
the contribution from \eqn{\Psi^*}), which is currently left as a placeholder.
}
